@keyframes half-borderTrail {
	0% {
		top: 10%;
		left: 20%;
		width: 20%;
		height: 3px;
		opacity: 1;
	}
	15% {
		top: 10%;
		left: 60%;
		width: 20%;
		height: 3px;
		opacity: 0.8;
	} /* Faster initial movement */
	25% {
		top: 10%;
		left: 95.5%;
		width: 3px;
		height: 3px;
		opacity: 0.6;
	}
	45% {
		top: 50%;
		left: 95.5%;
		width: 3px;
		height: 30%;
		opacity: 0.7;
	}
	55% {
		top: 76%;
		left: 95.5%;
		width: 3px;
		height: 3px;
		opacity: 0.9;
	}
	75% {
		top: 76%;
		left: 85%;
		width: 10%;
		height: 3px;
		opacity: 1;
	} /* More uniform pacing */
	100% {
		top: 76%;
		left: 70%;
		width: 20%;
		height: 3px;
		opacity: 0;
	}
}
/* rotate jumpy icon */

@keyframes iconAnimation-open {
	0% {
		transform: rotate(0deg) scale(1);
	}

	50% {
		transform: rotate(360deg) scale(1.2);
		/* Jumpy scaling */
	}

	75% {
		transform: rotate(360deg) scale(0.9);
	}

	100% {
		transform: rotate(360deg) scale(1);
	}
}

/* rotate jumpy icon inverted */

@keyframes iconAnimation-close {
	0% {
		transform: rotate(0deg) scale(1);
	}

	50% {
		transform: rotate(-360deg) scale(1.2);
		/* Jumpy scaling */
	}

	75% {
		transform: rotate(-360deg) scale(0.9);
	}

	100% {
		transform: rotate(-360deg) scale(1);
	}
}

/* animation for rotating icons on hover */
@keyframes icon-rotate-hover {
	0% {
		transform: rotate(0deg);
	}

	100% {
		transform: rotate(360deg);
	}
}

#urlbar-results {
	/* This is CRITICAL: It tells Firefox to animate any change to the 'height' property */
	transition: height 180ms ease-in-out !important;
	overflow-y: auto !important;
}

@media (-moz-pref('nug.url.bar.animation', 1)) {
	@media (-moz-pref('zen.urlbar.behavior', 'float')) {
		#urlbar[breakout-extend='true'] {
			transition: top 0.5s ease, width 0.3s ease;
		}
		#urlbar[open][zen-floating-urlbar='true'] {
			--urlbar-container-height: 4.5rem !important;
			min-width: min(60%, 10rem) !important;

			width: min(70%, 57rem) !important;

			& #urlbar-background {
				transition: border-radius 0.4s ease !important;
			}

			& .urlbarView {
				transition: opacity 0.1s ease !important;
			}
		}
	}
}
/* =================================================================================== */
/*  Zen Floating URL Bar - Initial Reveal Animation (Works with Animation Script)      */
/* =================================================================================== */

@media (-moz-pref('nug.url.bar.minimal', 1)) {
	@media (-moz-pref('zen.urlbar.behavior', 'float')) {
		/*
   * STATE 1: HIDDEN
   * When the urlbar is open but the user IS NOT typing.
   */
		#urlbar[open]:not([usertyping='']) > .urlbarView {
			max-height: 0 !important; /* Collapse the height */

			overflow: hidden !important; /* Crucial: hide the content inside */

			/* Define the animation for when it closes */
			transition: max-height 0.4s ease !important;
		}

		/*
   * STATE 2: VISIBLE
   * When the urlbar is open AND the user IS typing.
   */
		#urlbar[open][usertyping=''] > .urlbarView {
			/*
     * Use a max-height much larger than the panel will ever be.
     * Our JavaScript's 'height' property will control the actual height,
     * but this allows the panel to animate open from 0.
     */
			max-height: 500px !important; /* Allow it to grow */

			/* Define the animation for when it opens */
			transition: max-height 0.3s ease !important;
		}
	}
}

@keyframes urlbar-bounce-and-shadow-pulse {
	/* --- TIMELINE START --- */
	0% {
		scale: 1;
		box-shadow: 0 0 20px 5px transparent; /* Glow is OFF */
	}

	/* --- GLOW APPEARS --- */
	25% {
		/* The glow quickly fades in to full brightness */
		box-shadow: 0 0 20px 5px color-mix(in srgb, var(--nug-search-gradient-start) 60%, transparent); /* Glow is ON */
	}

	/* --- BOUNCE & GLOW HOLD --- */
	50% {
		scale: 0.93;
		box-shadow: 0 0 80px 8px color-mix(in srgb, var(--nug-search-gradient-start) 80%, transparent); /* Glow STAYS ON */
	}
	80% {
		scale: 0.95;
		box-shadow: 0 0 120px 8px color-mix(in srgb, var(--nug-search-gradient-start) 80%, transparent); /* Glow STAYS ON */
	}

	/* --- GLOW FADES OUT & BOUNCE SETTLES --- */
	100% {
		scale: 0.98;
		box-shadow: 0 0 120px 8px transparent; /* Glow is OFF */
	}
}

/* Part 2: Prepare the URL bar (no changes here) */
#urlbar {
	transform-origin: left !important;
}

/* Part 3: Trigger the animation (no changes here) */
#urlbar[searchmode] {
	/* You can also adjust the master duration here. Try 500ms for a slower overall effect. */
	animation: urlbar-bounce-and-shadow-pulse 450ms ease-out forwards;
	border-radius: var(--url-bar-border_radius, 1.7rem) !important;
}
