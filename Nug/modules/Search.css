@media not (-moz-pref('nug-features-disabled')) {
	@media not (-moz-pref('nug-features-search-disabled')) {
		@media (-moz-pref('zen.urlbar.behavior', 'float')) {
			:root:not([animating-background='true']) #urlbar[open=''][focused=''][zen-floating-urlbar='true'][usertyping=''] {
				@media (-moz-pref('browser.urlbar.maxRichResults', 7)) {
					top: 28% !important;

					& .urlbarView {
						min-height: calc((10px + 10px + var(--Auxiliar-Row-Height) * 7)) !important;
					}
				}

				@media (-moz-pref('browser.urlbar.maxRichResults', 6)) {
					top: 30% !important;

					& .urlbarView {
						min-height: calc((10px + 10px + var(--Auxiliar-Row-Height) * 6)) !important;
					}
				}

				@media (-moz-pref('browser.urlbar.maxRichResults', 5)) {
					top: 32% !important;

					& .urlbarView {
						min-height: calc((10px + 10px + var(--Auxiliar-Row-Height) * 5)) !important;
					}
				}

				@media (-moz-pref('browser.urlbar.maxRichResults', 4)) {
					top: 34% !important;

					& .urlbarView {
						min-height: calc((10px + 10px + var(--Auxiliar-Row-Height) * 4)) !important;
					}
				}

				@media (-moz-pref('browser.urlbar.maxRichResults', 3)) {
					top: 36% !important;

					& .urlbarView {
						min-height: calc((10px + 10px + var(--Auxiliar-Row-Height) * 3)) !important;
					}
				}

				& .urlbarView {
					opacity: 1 !important;

					transition: min-height 0.5s ease, opacity 0.5s ease 100ms !important;
				}
			}
		}
	}
}

:root:not([animating-background='true']) {
	@media not (-moz-pref('nug-features-disabled')) {
		@media not (-moz-pref('nug-features-search-disabled')) {
			@media (-moz-pref('zen.urlbar.behavior', 'float')) {
				#zen-main-app-wrapper::after {
					position: absolute !important;
					align-self: center !important;
					justify-self: center !important;
					z-index: -999 !important;
					content: '' !important;
					background: var(--nug-Background-Color);

					width: 0px;
					align-self: center !important;
					opacity: 0;
					margin-top: 0px !important;
					margin-bottom: 0px !important;
					margin-left: 0.5px !important;

					height: calc(var(--nug-Zen-URL-Height) - 2px);
					left: auto !important;
					right: auto !important;
					bottom: unset;
					top: calc(45% + 1px);

					border-radius: 8px;
					visibility: visible !important;

					transition: top 0.5s ease, height 0.5s ease, width 0.5s ease;
				}

				:has(#urlbar[open=''][focused=''][zen-floating-urlbar='true']) {
					#zen-main-app-wrapper::after {
						opacity: 1 !important;
						width: min(calc(90% - 2px), calc(65rem - var(--zen-element-separation) / 4)) !important;
					}
				}

				#zen-main-app-wrapper {
					display: flex !important;
					justify-content: center !important;
				}
			}
		}
	}
}

/* Top alignment for fixed position */
@media not (-moz-pref('nug-features-disabled')) {
	@media not (-moz-pref('nug-features-search-disabled')) {
		@media (-moz-pref('zen.urlbar.behavior', 'float')) {
			:root:not([animating-background='true']):has(
					#urlbar[open=''][focused=''][zen-floating-urlbar='true'][usertyping='']
				) {
				@media (-moz-pref('browser.urlbar.maxRichResults', 7)) {
					#zen-main-app-wrapper::after {
						top: calc(28% + var(--zen-element-separation) / 4) !important;
					}
				}

				@media (-moz-pref('browser.urlbar.maxRichResults', 6)) {
					#zen-main-app-wrapper::after {
						top: calc(30% + var(--zen-element-separation) / 4) !important;
					}
				}

				@media (-moz-pref('browser.urlbar.maxRichResults', 5)) {
					#zen-main-app-wrapper::after {
						top: calc(32% + var(--zen-element-separation) / 4) !important;
					}
				}

				@media (-moz-pref('browser.urlbar.maxRichResults', 4)) {
					#zen-main-app-wrapper::after {
						top: calc(34% + var(--zen-element-separation) / 4) !important;
					}
				}

				@media (-moz-pref('browser.urlbar.maxRichResults', 3)) {
					#zen-main-app-wrapper::after {
						top: calc(36% + var(--zen-element-separation) / 4) !important;
					}
				}

				@media not (-moz-pref('nug-features-ultra-search-enabled')) {
					@media (-moz-pref('browser.urlbar.maxRichResults', 7)) {
						#zen-main-app-wrapper::after {
							height: calc(7px + 10px + var(--urlbar-container-height) + var(--Auxiliar-Row-Height) * 7) !important;
						}
					}

					@media (-moz-pref('browser.urlbar.maxRichResults', 6)) {
						#zen-main-app-wrapper::after {
							height: calc(7px + 10px + var(--urlbar-container-height) + var(--Auxiliar-Row-Height) * 6) !important;
						}
					}

					@media (-moz-pref('browser.urlbar.maxRichResults', 5)) {
						#zen-main-app-wrapper::after {
							height: calc(7px + 10px + var(--urlbar-container-height) + var(--Auxiliar-Row-Height) * 5) !important;
						}
					}

					@media (-moz-pref('browser.urlbar.maxRichResults', 4)) {
						#zen-main-app-wrapper::after {
							height: calc(7px + 10px + var(--urlbar-container-height) + var(--Auxiliar-Row-Height) * 4) !important;
						}
					}

					@media (-moz-pref('browser.urlbar.maxRichResults', 3)) {
						#zen-main-app-wrapper::after {
							height: calc(7px + 10px + var(--urlbar-container-height) + var(--Auxiliar-Row-Height) * 3) !important;
						}
					}
				}
			}
		}
	}
}

:root {
	--Auxiliar-Row-Height: calc(var(--nug-Rows-Height) + var(--nug-Margin-Height) + 4px) !important;
}

@media not (-moz-pref('nug-features-disabled')) {
	@media not (-moz-pref('nug-features-search-disabled')) {
		:root {
			--nug-Zen-URL-Height: 50px;
			--urlbar-container-height: var(--nug-Zen-URL-Height) !important;
		}

		:root:not([animating-background='true']) {
			#urlbar {
				transition: top 0.5s ease, width 0.5s ease;
			}

			#urlbar[open] #urlbar-background {
				background: var(--nug-Blur-Color) !important;
				backdrop-filter: var(--nug-Blur) !important;
				border-radius: calc(var(--nug-Border-Radius) + 2px) !important;
			}

			#urlbar[open] {
				@media (-moz-pref('zen.urlbar.behavior', 'float')) {
					top: 45% !important;
				}

				width: min(90%, 65rem) !important;
			}

			#urlbar[open][zen-floating-urlbar='true'] {
				--urlbar-container-height: var(--nug-Zen-URL-Height) !important;

				& .urlbarView {
					@media (-moz-pref('zen.urlbar.behavior', 'float')) {
						min-height: 0px !important;
						max-height: 0px !important;
						opacity: 0 !important;
					}

					transition: min-height 0.5s ease, opacity 0.1s ease !important;

					& #urlbar-results {
						display: flex !important;
						flex-direction: column !important;
						overflow: auto !important;
						padding: 10px 10px 0px 10px !important;
						justify-content: center !important;

						& .urlbarView-row {
							height: var(--nug-Rows-Height) !important;
							min-height: var(--nug-Rows-Height) !important;
							max-height: var(--nug-Rows-Height) !important;
							margin-top: 0px !important;
							margin-bottom: var(--nug-Margin-Height) !important;
						}
					}
				}
			}
		}
	}
}
